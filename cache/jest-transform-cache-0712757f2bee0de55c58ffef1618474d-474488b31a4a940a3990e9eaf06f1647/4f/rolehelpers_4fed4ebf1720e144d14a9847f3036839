4a8b754636acd94b3c23d9462f75640e
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.computeAriaChecked = computeAriaChecked;
exports.computeAriaCurrent = computeAriaCurrent;
exports.computeAriaExpanded = computeAriaExpanded;
exports.computeAriaPressed = computeAriaPressed;
exports.computeAriaSelected = computeAriaSelected;
exports.computeHeadingLevel = computeHeadingLevel;
exports.getImplicitAriaRoles = getImplicitAriaRoles;
exports.getRoles = getRoles;
exports.isInaccessible = isInaccessible;
exports.isSubtreeInaccessible = isSubtreeInaccessible;
exports.logRoles = void 0;
exports.prettyRoles = prettyRoles;
var _ariaQuery = require("aria-query");
var _domAccessibilityApi = require("dom-accessibility-api");
var _prettyDom = require("./pretty-dom");
var _config = require("./config");
const elementRoleList = buildElementRoleList(_ariaQuery.elementRoles);

/**
 * @param {Element} element -
 * @returns {boolean} - `true` if `element` and its subtree are inaccessible
 */
function isSubtreeInaccessible(element) {
  if (element.hidden === true) {
    return true;
  }
  if (element.getAttribute('aria-hidden') === 'true') {
    return true;
  }
  const window = element.ownerDocument.defaultView;
  if (window.getComputedStyle(element).display === 'none') {
    return true;
  }
  return false;
}

/**
 * Partial implementation https://www.w3.org/TR/wai-aria-1.2/#tree_exclusion
 * which should only be used for elements with a non-presentational role i.e.
 * `role="none"` and `role="presentation"` will not be excluded.
 *
 * Implements aria-hidden semantics (i.e. parent overrides child)
 * Ignores "Child Presentational: True" characteristics
 *
 * @param {Element} element -
 * @param {object} [options] -
 * @param {function (element: Element): boolean} options.isSubtreeInaccessible -
 * can be used to return cached results from previous isSubtreeInaccessible calls
 * @returns {boolean} true if excluded, otherwise false
 */
function isInaccessible(element, options = {}) {
  const {
    isSubtreeInaccessible: isSubtreeInaccessibleImpl = isSubtreeInaccessible
  } = options;
  const window = element.ownerDocument.defaultView;
  // since visibility is inherited we can exit early
  if (window.getComputedStyle(element).visibility === 'hidden') {
    return true;
  }
  let currentElement = element;
  while (currentElement) {
    if (isSubtreeInaccessibleImpl(currentElement)) {
      return true;
    }
    currentElement = currentElement.parentElement;
  }
  return false;
}
function getImplicitAriaRoles(currentNode) {
  // eslint bug here:
  // eslint-disable-next-line no-unused-vars
  for (const {
    match,
    roles
  } of elementRoleList) {
    if (match(currentNode)) {
      return [...roles];
    }
  }
  return [];
}
function buildElementRoleList(elementRolesMap) {
  function makeElementSelector({
    name,
    attributes
  }) {
    return `${name}${attributes.map(({
      name: attributeName,
      value,
      constraints = []
    }) => {
      const shouldNotExist = constraints.indexOf('undefined') !== -1;
      if (shouldNotExist) {
        return `:not([${attributeName}])`;
      } else if (value) {
        return `[${attributeName}="${value}"]`;
      } else {
        return `[${attributeName}]`;
      }
    }).join('')}`;
  }
  function getSelectorSpecificity({
    attributes = []
  }) {
    return attributes.length;
  }
  function bySelectorSpecificity({
    specificity: leftSpecificity
  }, {
    specificity: rightSpecificity
  }) {
    return rightSpecificity - leftSpecificity;
  }
  function match(element) {
    let {
      attributes = []
    } = element;

    // https://github.com/testing-library/dom-testing-library/issues/814
    const typeTextIndex = attributes.findIndex(attribute => attribute.value && attribute.name === 'type' && attribute.value === 'text');
    if (typeTextIndex >= 0) {
      // not using splice to not mutate the attributes array
      attributes = [...attributes.slice(0, typeTextIndex), ...attributes.slice(typeTextIndex + 1)];
    }
    const selector = makeElementSelector({
      ...element,
      attributes
    });
    return node => {
      if (typeTextIndex >= 0 && node.type !== 'text') {
        return false;
      }
      return node.matches(selector);
    };
  }
  let result = [];

  // eslint bug here:
  // eslint-disable-next-line no-unused-vars
  for (const [element, roles] of elementRolesMap.entries()) {
    result = [...result, {
      match: match(element),
      roles: Array.from(roles),
      specificity: getSelectorSpecificity(element)
    }];
  }
  return result.sort(bySelectorSpecificity);
}
function getRoles(container, {
  hidden = false
} = {}) {
  function flattenDOM(node) {
    return [node, ...Array.from(node.children).reduce((acc, child) => [...acc, ...flattenDOM(child)], [])];
  }
  return flattenDOM(container).filter(element => {
    return hidden === false ? isInaccessible(element) === false : true;
  }).reduce((acc, node) => {
    let roles = [];
    // TODO: This violates html-aria which does not allow any role on every element
    if (node.hasAttribute('role')) {
      roles = node.getAttribute('role').split(' ').slice(0, 1);
    } else {
      roles = getImplicitAriaRoles(node);
    }
    return roles.reduce((rolesAcc, role) => Array.isArray(rolesAcc[role]) ? {
      ...rolesAcc,
      [role]: [...rolesAcc[role], node]
    } : {
      ...rolesAcc,
      [role]: [node]
    }, acc);
  }, {});
}
function prettyRoles(dom, {
  hidden,
  includeDescription
}) {
  const roles = getRoles(dom, {
    hidden
  });
  // We prefer to skip generic role, we don't recommend it
  return Object.entries(roles).filter(([role]) => role !== 'generic').map(([role, elements]) => {
    const delimiterBar = '-'.repeat(50);
    const elementsString = elements.map(el => {
      const nameString = `Name "${(0, _domAccessibilityApi.computeAccessibleName)(el, {
        computedStyleSupportsPseudoElements: (0, _config.getConfig)().computedStyleSupportsPseudoElements
      })}":\n`;
      const domString = (0, _prettyDom.prettyDOM)(el.cloneNode(false));
      if (includeDescription) {
        const descriptionString = `Description "${(0, _domAccessibilityApi.computeAccessibleDescription)(el, {
          computedStyleSupportsPseudoElements: (0, _config.getConfig)().computedStyleSupportsPseudoElements
        })}":\n`;
        return `${nameString}${descriptionString}${domString}`;
      }
      return `${nameString}${domString}`;
    }).join('\n\n');
    return `${role}:\n\n${elementsString}\n\n${delimiterBar}`;
  }).join('\n');
}
const logRoles = (dom, {
  hidden = false
} = {}) => console.log(prettyRoles(dom, {
  hidden
}));

/**
 * @param {Element} element -
 * @returns {boolean | undefined} - false/true if (not)selected, undefined if not selectable
 */
exports.logRoles = logRoles;
function computeAriaSelected(element) {
  // implicit value from html-aam mappings: https://www.w3.org/TR/html-aam-1.0/#html-attribute-state-and-property-mappings
  // https://www.w3.org/TR/html-aam-1.0/#details-id-97
  if (element.tagName === 'OPTION') {
    return element.selected;
  }

  // explicit value
  return checkBooleanAttribute(element, 'aria-selected');
}

/**
 * @param {Element} element -
 * @returns {boolean | undefined} - false/true if (not)checked, undefined if not checked-able
 */
function computeAriaChecked(element) {
  // implicit value from html-aam mappings: https://www.w3.org/TR/html-aam-1.0/#html-attribute-state-and-property-mappings
  // https://www.w3.org/TR/html-aam-1.0/#details-id-56
  // https://www.w3.org/TR/html-aam-1.0/#details-id-67
  if ('indeterminate' in element && element.indeterminate) {
    return undefined;
  }
  if ('checked' in element) {
    return element.checked;
  }

  // explicit value
  return checkBooleanAttribute(element, 'aria-checked');
}

/**
 * @param {Element} element -
 * @returns {boolean | undefined} - false/true if (not)pressed, undefined if not press-able
 */
function computeAriaPressed(element) {
  // https://www.w3.org/TR/wai-aria-1.1/#aria-pressed
  return checkBooleanAttribute(element, 'aria-pressed');
}

/**
 * @param {Element} element -
 * @returns {boolean | string | null} -
 */
function computeAriaCurrent(element) {
  var _ref, _checkBooleanAttribut;
  // https://www.w3.org/TR/wai-aria-1.1/#aria-current
  return (_ref = (_checkBooleanAttribut = checkBooleanAttribute(element, 'aria-current')) != null ? _checkBooleanAttribut : element.getAttribute('aria-current')) != null ? _ref : false;
}

/**
 * @param {Element} element -
 * @returns {boolean | undefined} - false/true if (not)expanded, undefined if not expand-able
 */
function computeAriaExpanded(element) {
  // https://www.w3.org/TR/wai-aria-1.1/#aria-expanded
  return checkBooleanAttribute(element, 'aria-expanded');
}
function checkBooleanAttribute(element, attribute) {
  const attributeValue = element.getAttribute(attribute);
  if (attributeValue === 'true') {
    return true;
  }
  if (attributeValue === 'false') {
    return false;
  }
  return undefined;
}

/**
 * @param {Element} element -
 * @returns {number | undefined} - number if implicit heading or aria-level present, otherwise undefined
 */
function computeHeadingLevel(element) {
  // https://w3c.github.io/html-aam/#el-h1-h6
  // https://w3c.github.io/html-aam/#el-h1-h6
  const implicitHeadingLevels = {
    H1: 1,
    H2: 2,
    H3: 3,
    H4: 4,
    H5: 5,
    H6: 6
  };
  // explicit aria-level value
  // https://www.w3.org/TR/wai-aria-1.2/#aria-level
  const ariaLevelAttribute = element.getAttribute('aria-level') && Number(element.getAttribute('aria-level'));
  return ariaLevelAttribute || implicitHeadingLevels[element.tagName];
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImNvbXB1dGVBcmlhQ2hlY2tlZCIsImNvbXB1dGVBcmlhQ3VycmVudCIsImNvbXB1dGVBcmlhRXhwYW5kZWQiLCJjb21wdXRlQXJpYVByZXNzZWQiLCJjb21wdXRlQXJpYVNlbGVjdGVkIiwiY29tcHV0ZUhlYWRpbmdMZXZlbCIsImdldEltcGxpY2l0QXJpYVJvbGVzIiwiZ2V0Um9sZXMiLCJpc0luYWNjZXNzaWJsZSIsImlzU3VidHJlZUluYWNjZXNzaWJsZSIsImxvZ1JvbGVzIiwicHJldHR5Um9sZXMiLCJfYXJpYVF1ZXJ5IiwicmVxdWlyZSIsIl9kb21BY2Nlc3NpYmlsaXR5QXBpIiwiX3ByZXR0eURvbSIsIl9jb25maWciLCJlbGVtZW50Um9sZUxpc3QiLCJidWlsZEVsZW1lbnRSb2xlTGlzdCIsImVsZW1lbnRSb2xlcyIsImVsZW1lbnQiLCJoaWRkZW4iLCJnZXRBdHRyaWJ1dGUiLCJ3aW5kb3ciLCJvd25lckRvY3VtZW50IiwiZGVmYXVsdFZpZXciLCJnZXRDb21wdXRlZFN0eWxlIiwiZGlzcGxheSIsIm9wdGlvbnMiLCJpc1N1YnRyZWVJbmFjY2Vzc2libGVJbXBsIiwidmlzaWJpbGl0eSIsImN1cnJlbnRFbGVtZW50IiwicGFyZW50RWxlbWVudCIsImN1cnJlbnROb2RlIiwibWF0Y2giLCJyb2xlcyIsImVsZW1lbnRSb2xlc01hcCIsIm1ha2VFbGVtZW50U2VsZWN0b3IiLCJuYW1lIiwiYXR0cmlidXRlcyIsIm1hcCIsImF0dHJpYnV0ZU5hbWUiLCJjb25zdHJhaW50cyIsInNob3VsZE5vdEV4aXN0IiwiaW5kZXhPZiIsImpvaW4iLCJnZXRTZWxlY3RvclNwZWNpZmljaXR5IiwibGVuZ3RoIiwiYnlTZWxlY3RvclNwZWNpZmljaXR5Iiwic3BlY2lmaWNpdHkiLCJsZWZ0U3BlY2lmaWNpdHkiLCJyaWdodFNwZWNpZmljaXR5IiwidHlwZVRleHRJbmRleCIsImZpbmRJbmRleCIsImF0dHJpYnV0ZSIsInNsaWNlIiwic2VsZWN0b3IiLCJub2RlIiwidHlwZSIsIm1hdGNoZXMiLCJyZXN1bHQiLCJlbnRyaWVzIiwiQXJyYXkiLCJmcm9tIiwic29ydCIsImNvbnRhaW5lciIsImZsYXR0ZW5ET00iLCJjaGlsZHJlbiIsInJlZHVjZSIsImFjYyIsImNoaWxkIiwiZmlsdGVyIiwiaGFzQXR0cmlidXRlIiwic3BsaXQiLCJyb2xlc0FjYyIsInJvbGUiLCJpc0FycmF5IiwiZG9tIiwiaW5jbHVkZURlc2NyaXB0aW9uIiwiZWxlbWVudHMiLCJkZWxpbWl0ZXJCYXIiLCJyZXBlYXQiLCJlbGVtZW50c1N0cmluZyIsImVsIiwibmFtZVN0cmluZyIsImNvbXB1dGVBY2Nlc3NpYmxlTmFtZSIsImNvbXB1dGVkU3R5bGVTdXBwb3J0c1BzZXVkb0VsZW1lbnRzIiwiZ2V0Q29uZmlnIiwiZG9tU3RyaW5nIiwicHJldHR5RE9NIiwiY2xvbmVOb2RlIiwiZGVzY3JpcHRpb25TdHJpbmciLCJjb21wdXRlQWNjZXNzaWJsZURlc2NyaXB0aW9uIiwiY29uc29sZSIsImxvZyIsInRhZ05hbWUiLCJzZWxlY3RlZCIsImNoZWNrQm9vbGVhbkF0dHJpYnV0ZSIsImluZGV0ZXJtaW5hdGUiLCJ1bmRlZmluZWQiLCJjaGVja2VkIiwiX3JlZiIsIl9jaGVja0Jvb2xlYW5BdHRyaWJ1dCIsImF0dHJpYnV0ZVZhbHVlIiwiaW1wbGljaXRIZWFkaW5nTGV2ZWxzIiwiSDEiLCJIMiIsIkgzIiwiSDQiLCJINSIsIkg2IiwiYXJpYUxldmVsQXR0cmlidXRlIiwiTnVtYmVyIl0sInNvdXJjZXMiOlsicm9sZS1oZWxwZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5jb21wdXRlQXJpYUNoZWNrZWQgPSBjb21wdXRlQXJpYUNoZWNrZWQ7XG5leHBvcnRzLmNvbXB1dGVBcmlhQ3VycmVudCA9IGNvbXB1dGVBcmlhQ3VycmVudDtcbmV4cG9ydHMuY29tcHV0ZUFyaWFFeHBhbmRlZCA9IGNvbXB1dGVBcmlhRXhwYW5kZWQ7XG5leHBvcnRzLmNvbXB1dGVBcmlhUHJlc3NlZCA9IGNvbXB1dGVBcmlhUHJlc3NlZDtcbmV4cG9ydHMuY29tcHV0ZUFyaWFTZWxlY3RlZCA9IGNvbXB1dGVBcmlhU2VsZWN0ZWQ7XG5leHBvcnRzLmNvbXB1dGVIZWFkaW5nTGV2ZWwgPSBjb21wdXRlSGVhZGluZ0xldmVsO1xuZXhwb3J0cy5nZXRJbXBsaWNpdEFyaWFSb2xlcyA9IGdldEltcGxpY2l0QXJpYVJvbGVzO1xuZXhwb3J0cy5nZXRSb2xlcyA9IGdldFJvbGVzO1xuZXhwb3J0cy5pc0luYWNjZXNzaWJsZSA9IGlzSW5hY2Nlc3NpYmxlO1xuZXhwb3J0cy5pc1N1YnRyZWVJbmFjY2Vzc2libGUgPSBpc1N1YnRyZWVJbmFjY2Vzc2libGU7XG5leHBvcnRzLmxvZ1JvbGVzID0gdm9pZCAwO1xuZXhwb3J0cy5wcmV0dHlSb2xlcyA9IHByZXR0eVJvbGVzO1xudmFyIF9hcmlhUXVlcnkgPSByZXF1aXJlKFwiYXJpYS1xdWVyeVwiKTtcbnZhciBfZG9tQWNjZXNzaWJpbGl0eUFwaSA9IHJlcXVpcmUoXCJkb20tYWNjZXNzaWJpbGl0eS1hcGlcIik7XG52YXIgX3ByZXR0eURvbSA9IHJlcXVpcmUoXCIuL3ByZXR0eS1kb21cIik7XG52YXIgX2NvbmZpZyA9IHJlcXVpcmUoXCIuL2NvbmZpZ1wiKTtcbmNvbnN0IGVsZW1lbnRSb2xlTGlzdCA9IGJ1aWxkRWxlbWVudFJvbGVMaXN0KF9hcmlhUXVlcnkuZWxlbWVudFJvbGVzKTtcblxuLyoqXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLVxuICogQHJldHVybnMge2Jvb2xlYW59IC0gYHRydWVgIGlmIGBlbGVtZW50YCBhbmQgaXRzIHN1YnRyZWUgYXJlIGluYWNjZXNzaWJsZVxuICovXG5mdW5jdGlvbiBpc1N1YnRyZWVJbmFjY2Vzc2libGUoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudC5oaWRkZW4gPT09IHRydWUpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJykgPT09ICd0cnVlJykge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGNvbnN0IHdpbmRvdyA9IGVsZW1lbnQub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldztcbiAgaWYgKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpLmRpc3BsYXkgPT09ICdub25lJykge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBQYXJ0aWFsIGltcGxlbWVudGF0aW9uIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93YWktYXJpYS0xLjIvI3RyZWVfZXhjbHVzaW9uXG4gKiB3aGljaCBzaG91bGQgb25seSBiZSB1c2VkIGZvciBlbGVtZW50cyB3aXRoIGEgbm9uLXByZXNlbnRhdGlvbmFsIHJvbGUgaS5lLlxuICogYHJvbGU9XCJub25lXCJgIGFuZCBgcm9sZT1cInByZXNlbnRhdGlvblwiYCB3aWxsIG5vdCBiZSBleGNsdWRlZC5cbiAqXG4gKiBJbXBsZW1lbnRzIGFyaWEtaGlkZGVuIHNlbWFudGljcyAoaS5lLiBwYXJlbnQgb3ZlcnJpZGVzIGNoaWxkKVxuICogSWdub3JlcyBcIkNoaWxkIFByZXNlbnRhdGlvbmFsOiBUcnVlXCIgY2hhcmFjdGVyaXN0aWNzXG4gKlxuICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IC1cbiAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLVxuICogQHBhcmFtIHtmdW5jdGlvbiAoZWxlbWVudDogRWxlbWVudCk6IGJvb2xlYW59IG9wdGlvbnMuaXNTdWJ0cmVlSW5hY2Nlc3NpYmxlIC1cbiAqIGNhbiBiZSB1c2VkIHRvIHJldHVybiBjYWNoZWQgcmVzdWx0cyBmcm9tIHByZXZpb3VzIGlzU3VidHJlZUluYWNjZXNzaWJsZSBjYWxsc1xuICogQHJldHVybnMge2Jvb2xlYW59IHRydWUgaWYgZXhjbHVkZWQsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0luYWNjZXNzaWJsZShlbGVtZW50LCBvcHRpb25zID0ge30pIHtcbiAgY29uc3Qge1xuICAgIGlzU3VidHJlZUluYWNjZXNzaWJsZTogaXNTdWJ0cmVlSW5hY2Nlc3NpYmxlSW1wbCA9IGlzU3VidHJlZUluYWNjZXNzaWJsZVxuICB9ID0gb3B0aW9ucztcbiAgY29uc3Qgd2luZG93ID0gZWxlbWVudC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3O1xuICAvLyBzaW5jZSB2aXNpYmlsaXR5IGlzIGluaGVyaXRlZCB3ZSBjYW4gZXhpdCBlYXJseVxuICBpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkudmlzaWJpbGl0eSA9PT0gJ2hpZGRlbicpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBsZXQgY3VycmVudEVsZW1lbnQgPSBlbGVtZW50O1xuICB3aGlsZSAoY3VycmVudEVsZW1lbnQpIHtcbiAgICBpZiAoaXNTdWJ0cmVlSW5hY2Nlc3NpYmxlSW1wbChjdXJyZW50RWxlbWVudCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBjdXJyZW50RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gZ2V0SW1wbGljaXRBcmlhUm9sZXMoY3VycmVudE5vZGUpIHtcbiAgLy8gZXNsaW50IGJ1ZyBoZXJlOlxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgZm9yIChjb25zdCB7XG4gICAgbWF0Y2gsXG4gICAgcm9sZXNcbiAgfSBvZiBlbGVtZW50Um9sZUxpc3QpIHtcbiAgICBpZiAobWF0Y2goY3VycmVudE5vZGUpKSB7XG4gICAgICByZXR1cm4gWy4uLnJvbGVzXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIFtdO1xufVxuZnVuY3Rpb24gYnVpbGRFbGVtZW50Um9sZUxpc3QoZWxlbWVudFJvbGVzTWFwKSB7XG4gIGZ1bmN0aW9uIG1ha2VFbGVtZW50U2VsZWN0b3Ioe1xuICAgIG5hbWUsXG4gICAgYXR0cmlidXRlc1xuICB9KSB7XG4gICAgcmV0dXJuIGAke25hbWV9JHthdHRyaWJ1dGVzLm1hcCgoe1xuICAgICAgbmFtZTogYXR0cmlidXRlTmFtZSxcbiAgICAgIHZhbHVlLFxuICAgICAgY29uc3RyYWludHMgPSBbXVxuICAgIH0pID0+IHtcbiAgICAgIGNvbnN0IHNob3VsZE5vdEV4aXN0ID0gY29uc3RyYWludHMuaW5kZXhPZigndW5kZWZpbmVkJykgIT09IC0xO1xuICAgICAgaWYgKHNob3VsZE5vdEV4aXN0KSB7XG4gICAgICAgIHJldHVybiBgOm5vdChbJHthdHRyaWJ1dGVOYW1lfV0pYDtcbiAgICAgIH0gZWxzZSBpZiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGBbJHthdHRyaWJ1dGVOYW1lfT1cIiR7dmFsdWV9XCJdYDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBgWyR7YXR0cmlidXRlTmFtZX1dYDtcbiAgICAgIH1cbiAgICB9KS5qb2luKCcnKX1gO1xuICB9XG4gIGZ1bmN0aW9uIGdldFNlbGVjdG9yU3BlY2lmaWNpdHkoe1xuICAgIGF0dHJpYnV0ZXMgPSBbXVxuICB9KSB7XG4gICAgcmV0dXJuIGF0dHJpYnV0ZXMubGVuZ3RoO1xuICB9XG4gIGZ1bmN0aW9uIGJ5U2VsZWN0b3JTcGVjaWZpY2l0eSh7XG4gICAgc3BlY2lmaWNpdHk6IGxlZnRTcGVjaWZpY2l0eVxuICB9LCB7XG4gICAgc3BlY2lmaWNpdHk6IHJpZ2h0U3BlY2lmaWNpdHlcbiAgfSkge1xuICAgIHJldHVybiByaWdodFNwZWNpZmljaXR5IC0gbGVmdFNwZWNpZmljaXR5O1xuICB9XG4gIGZ1bmN0aW9uIG1hdGNoKGVsZW1lbnQpIHtcbiAgICBsZXQge1xuICAgICAgYXR0cmlidXRlcyA9IFtdXG4gICAgfSA9IGVsZW1lbnQ7XG5cbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdGVzdGluZy1saWJyYXJ5L2RvbS10ZXN0aW5nLWxpYnJhcnkvaXNzdWVzLzgxNFxuICAgIGNvbnN0IHR5cGVUZXh0SW5kZXggPSBhdHRyaWJ1dGVzLmZpbmRJbmRleChhdHRyaWJ1dGUgPT4gYXR0cmlidXRlLnZhbHVlICYmIGF0dHJpYnV0ZS5uYW1lID09PSAndHlwZScgJiYgYXR0cmlidXRlLnZhbHVlID09PSAndGV4dCcpO1xuICAgIGlmICh0eXBlVGV4dEluZGV4ID49IDApIHtcbiAgICAgIC8vIG5vdCB1c2luZyBzcGxpY2UgdG8gbm90IG11dGF0ZSB0aGUgYXR0cmlidXRlcyBhcnJheVxuICAgICAgYXR0cmlidXRlcyA9IFsuLi5hdHRyaWJ1dGVzLnNsaWNlKDAsIHR5cGVUZXh0SW5kZXgpLCAuLi5hdHRyaWJ1dGVzLnNsaWNlKHR5cGVUZXh0SW5kZXggKyAxKV07XG4gICAgfVxuICAgIGNvbnN0IHNlbGVjdG9yID0gbWFrZUVsZW1lbnRTZWxlY3Rvcih7XG4gICAgICAuLi5lbGVtZW50LFxuICAgICAgYXR0cmlidXRlc1xuICAgIH0pO1xuICAgIHJldHVybiBub2RlID0+IHtcbiAgICAgIGlmICh0eXBlVGV4dEluZGV4ID49IDAgJiYgbm9kZS50eXBlICE9PSAndGV4dCcpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5vZGUubWF0Y2hlcyhzZWxlY3Rvcik7XG4gICAgfTtcbiAgfVxuICBsZXQgcmVzdWx0ID0gW107XG5cbiAgLy8gZXNsaW50IGJ1ZyBoZXJlOlxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgZm9yIChjb25zdCBbZWxlbWVudCwgcm9sZXNdIG9mIGVsZW1lbnRSb2xlc01hcC5lbnRyaWVzKCkpIHtcbiAgICByZXN1bHQgPSBbLi4ucmVzdWx0LCB7XG4gICAgICBtYXRjaDogbWF0Y2goZWxlbWVudCksXG4gICAgICByb2xlczogQXJyYXkuZnJvbShyb2xlcyksXG4gICAgICBzcGVjaWZpY2l0eTogZ2V0U2VsZWN0b3JTcGVjaWZpY2l0eShlbGVtZW50KVxuICAgIH1dO1xuICB9XG4gIHJldHVybiByZXN1bHQuc29ydChieVNlbGVjdG9yU3BlY2lmaWNpdHkpO1xufVxuZnVuY3Rpb24gZ2V0Um9sZXMoY29udGFpbmVyLCB7XG4gIGhpZGRlbiA9IGZhbHNlXG59ID0ge30pIHtcbiAgZnVuY3Rpb24gZmxhdHRlbkRPTShub2RlKSB7XG4gICAgcmV0dXJuIFtub2RlLCAuLi5BcnJheS5mcm9tKG5vZGUuY2hpbGRyZW4pLnJlZHVjZSgoYWNjLCBjaGlsZCkgPT4gWy4uLmFjYywgLi4uZmxhdHRlbkRPTShjaGlsZCldLCBbXSldO1xuICB9XG4gIHJldHVybiBmbGF0dGVuRE9NKGNvbnRhaW5lcikuZmlsdGVyKGVsZW1lbnQgPT4ge1xuICAgIHJldHVybiBoaWRkZW4gPT09IGZhbHNlID8gaXNJbmFjY2Vzc2libGUoZWxlbWVudCkgPT09IGZhbHNlIDogdHJ1ZTtcbiAgfSkucmVkdWNlKChhY2MsIG5vZGUpID0+IHtcbiAgICBsZXQgcm9sZXMgPSBbXTtcbiAgICAvLyBUT0RPOiBUaGlzIHZpb2xhdGVzIGh0bWwtYXJpYSB3aGljaCBkb2VzIG5vdCBhbGxvdyBhbnkgcm9sZSBvbiBldmVyeSBlbGVtZW50XG4gICAgaWYgKG5vZGUuaGFzQXR0cmlidXRlKCdyb2xlJykpIHtcbiAgICAgIHJvbGVzID0gbm9kZS5nZXRBdHRyaWJ1dGUoJ3JvbGUnKS5zcGxpdCgnICcpLnNsaWNlKDAsIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICByb2xlcyA9IGdldEltcGxpY2l0QXJpYVJvbGVzKG5vZGUpO1xuICAgIH1cbiAgICByZXR1cm4gcm9sZXMucmVkdWNlKChyb2xlc0FjYywgcm9sZSkgPT4gQXJyYXkuaXNBcnJheShyb2xlc0FjY1tyb2xlXSkgPyB7XG4gICAgICAuLi5yb2xlc0FjYyxcbiAgICAgIFtyb2xlXTogWy4uLnJvbGVzQWNjW3JvbGVdLCBub2RlXVxuICAgIH0gOiB7XG4gICAgICAuLi5yb2xlc0FjYyxcbiAgICAgIFtyb2xlXTogW25vZGVdXG4gICAgfSwgYWNjKTtcbiAgfSwge30pO1xufVxuZnVuY3Rpb24gcHJldHR5Um9sZXMoZG9tLCB7XG4gIGhpZGRlbixcbiAgaW5jbHVkZURlc2NyaXB0aW9uXG59KSB7XG4gIGNvbnN0IHJvbGVzID0gZ2V0Um9sZXMoZG9tLCB7XG4gICAgaGlkZGVuXG4gIH0pO1xuICAvLyBXZSBwcmVmZXIgdG8gc2tpcCBnZW5lcmljIHJvbGUsIHdlIGRvbid0IHJlY29tbWVuZCBpdFxuICByZXR1cm4gT2JqZWN0LmVudHJpZXMocm9sZXMpLmZpbHRlcigoW3JvbGVdKSA9PiByb2xlICE9PSAnZ2VuZXJpYycpLm1hcCgoW3JvbGUsIGVsZW1lbnRzXSkgPT4ge1xuICAgIGNvbnN0IGRlbGltaXRlckJhciA9ICctJy5yZXBlYXQoNTApO1xuICAgIGNvbnN0IGVsZW1lbnRzU3RyaW5nID0gZWxlbWVudHMubWFwKGVsID0+IHtcbiAgICAgIGNvbnN0IG5hbWVTdHJpbmcgPSBgTmFtZSBcIiR7KDAsIF9kb21BY2Nlc3NpYmlsaXR5QXBpLmNvbXB1dGVBY2Nlc3NpYmxlTmFtZSkoZWwsIHtcbiAgICAgICAgY29tcHV0ZWRTdHlsZVN1cHBvcnRzUHNldWRvRWxlbWVudHM6ICgwLCBfY29uZmlnLmdldENvbmZpZykoKS5jb21wdXRlZFN0eWxlU3VwcG9ydHNQc2V1ZG9FbGVtZW50c1xuICAgICAgfSl9XCI6XFxuYDtcbiAgICAgIGNvbnN0IGRvbVN0cmluZyA9ICgwLCBfcHJldHR5RG9tLnByZXR0eURPTSkoZWwuY2xvbmVOb2RlKGZhbHNlKSk7XG4gICAgICBpZiAoaW5jbHVkZURlc2NyaXB0aW9uKSB7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uU3RyaW5nID0gYERlc2NyaXB0aW9uIFwiJHsoMCwgX2RvbUFjY2Vzc2liaWxpdHlBcGkuY29tcHV0ZUFjY2Vzc2libGVEZXNjcmlwdGlvbikoZWwsIHtcbiAgICAgICAgICBjb21wdXRlZFN0eWxlU3VwcG9ydHNQc2V1ZG9FbGVtZW50czogKDAsIF9jb25maWcuZ2V0Q29uZmlnKSgpLmNvbXB1dGVkU3R5bGVTdXBwb3J0c1BzZXVkb0VsZW1lbnRzXG4gICAgICAgIH0pfVwiOlxcbmA7XG4gICAgICAgIHJldHVybiBgJHtuYW1lU3RyaW5nfSR7ZGVzY3JpcHRpb25TdHJpbmd9JHtkb21TdHJpbmd9YDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBgJHtuYW1lU3RyaW5nfSR7ZG9tU3RyaW5nfWA7XG4gICAgfSkuam9pbignXFxuXFxuJyk7XG4gICAgcmV0dXJuIGAke3JvbGV9OlxcblxcbiR7ZWxlbWVudHNTdHJpbmd9XFxuXFxuJHtkZWxpbWl0ZXJCYXJ9YDtcbiAgfSkuam9pbignXFxuJyk7XG59XG5jb25zdCBsb2dSb2xlcyA9IChkb20sIHtcbiAgaGlkZGVuID0gZmFsc2Vcbn0gPSB7fSkgPT4gY29uc29sZS5sb2cocHJldHR5Um9sZXMoZG9tLCB7XG4gIGhpZGRlblxufSkpO1xuXG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtXG4gKiBAcmV0dXJucyB7Ym9vbGVhbiB8IHVuZGVmaW5lZH0gLSBmYWxzZS90cnVlIGlmIChub3Qpc2VsZWN0ZWQsIHVuZGVmaW5lZCBpZiBub3Qgc2VsZWN0YWJsZVxuICovXG5leHBvcnRzLmxvZ1JvbGVzID0gbG9nUm9sZXM7XG5mdW5jdGlvbiBjb21wdXRlQXJpYVNlbGVjdGVkKGVsZW1lbnQpIHtcbiAgLy8gaW1wbGljaXQgdmFsdWUgZnJvbSBodG1sLWFhbSBtYXBwaW5nczogaHR0cHM6Ly93d3cudzMub3JnL1RSL2h0bWwtYWFtLTEuMC8jaHRtbC1hdHRyaWJ1dGUtc3RhdGUtYW5kLXByb3BlcnR5LW1hcHBpbmdzXG4gIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9odG1sLWFhbS0xLjAvI2RldGFpbHMtaWQtOTdcbiAgaWYgKGVsZW1lbnQudGFnTmFtZSA9PT0gJ09QVElPTicpIHtcbiAgICByZXR1cm4gZWxlbWVudC5zZWxlY3RlZDtcbiAgfVxuXG4gIC8vIGV4cGxpY2l0IHZhbHVlXG4gIHJldHVybiBjaGVja0Jvb2xlYW5BdHRyaWJ1dGUoZWxlbWVudCwgJ2FyaWEtc2VsZWN0ZWQnKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLVxuICogQHJldHVybnMge2Jvb2xlYW4gfCB1bmRlZmluZWR9IC0gZmFsc2UvdHJ1ZSBpZiAobm90KWNoZWNrZWQsIHVuZGVmaW5lZCBpZiBub3QgY2hlY2tlZC1hYmxlXG4gKi9cbmZ1bmN0aW9uIGNvbXB1dGVBcmlhQ2hlY2tlZChlbGVtZW50KSB7XG4gIC8vIGltcGxpY2l0IHZhbHVlIGZyb20gaHRtbC1hYW0gbWFwcGluZ3M6IGh0dHBzOi8vd3d3LnczLm9yZy9UUi9odG1sLWFhbS0xLjAvI2h0bWwtYXR0cmlidXRlLXN0YXRlLWFuZC1wcm9wZXJ0eS1tYXBwaW5nc1xuICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvaHRtbC1hYW0tMS4wLyNkZXRhaWxzLWlkLTU2XG4gIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9odG1sLWFhbS0xLjAvI2RldGFpbHMtaWQtNjdcbiAgaWYgKCdpbmRldGVybWluYXRlJyBpbiBlbGVtZW50ICYmIGVsZW1lbnQuaW5kZXRlcm1pbmF0ZSkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgaWYgKCdjaGVja2VkJyBpbiBlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQuY2hlY2tlZDtcbiAgfVxuXG4gIC8vIGV4cGxpY2l0IHZhbHVlXG4gIHJldHVybiBjaGVja0Jvb2xlYW5BdHRyaWJ1dGUoZWxlbWVudCwgJ2FyaWEtY2hlY2tlZCcpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtXG4gKiBAcmV0dXJucyB7Ym9vbGVhbiB8IHVuZGVmaW5lZH0gLSBmYWxzZS90cnVlIGlmIChub3QpcHJlc3NlZCwgdW5kZWZpbmVkIGlmIG5vdCBwcmVzcy1hYmxlXG4gKi9cbmZ1bmN0aW9uIGNvbXB1dGVBcmlhUHJlc3NlZChlbGVtZW50KSB7XG4gIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93YWktYXJpYS0xLjEvI2FyaWEtcHJlc3NlZFxuICByZXR1cm4gY2hlY2tCb29sZWFuQXR0cmlidXRlKGVsZW1lbnQsICdhcmlhLXByZXNzZWQnKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLVxuICogQHJldHVybnMge2Jvb2xlYW4gfCBzdHJpbmcgfCBudWxsfSAtXG4gKi9cbmZ1bmN0aW9uIGNvbXB1dGVBcmlhQ3VycmVudChlbGVtZW50KSB7XG4gIHZhciBfcmVmLCBfY2hlY2tCb29sZWFuQXR0cmlidXQ7XG4gIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93YWktYXJpYS0xLjEvI2FyaWEtY3VycmVudFxuICByZXR1cm4gKF9yZWYgPSAoX2NoZWNrQm9vbGVhbkF0dHJpYnV0ID0gY2hlY2tCb29sZWFuQXR0cmlidXRlKGVsZW1lbnQsICdhcmlhLWN1cnJlbnQnKSkgIT0gbnVsbCA/IF9jaGVja0Jvb2xlYW5BdHRyaWJ1dCA6IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdhcmlhLWN1cnJlbnQnKSkgIT0gbnVsbCA/IF9yZWYgOiBmYWxzZTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLVxuICogQHJldHVybnMge2Jvb2xlYW4gfCB1bmRlZmluZWR9IC0gZmFsc2UvdHJ1ZSBpZiAobm90KWV4cGFuZGVkLCB1bmRlZmluZWQgaWYgbm90IGV4cGFuZC1hYmxlXG4gKi9cbmZ1bmN0aW9uIGNvbXB1dGVBcmlhRXhwYW5kZWQoZWxlbWVudCkge1xuICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvd2FpLWFyaWEtMS4xLyNhcmlhLWV4cGFuZGVkXG4gIHJldHVybiBjaGVja0Jvb2xlYW5BdHRyaWJ1dGUoZWxlbWVudCwgJ2FyaWEtZXhwYW5kZWQnKTtcbn1cbmZ1bmN0aW9uIGNoZWNrQm9vbGVhbkF0dHJpYnV0ZShlbGVtZW50LCBhdHRyaWJ1dGUpIHtcbiAgY29uc3QgYXR0cmlidXRlVmFsdWUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICBpZiAoYXR0cmlidXRlVmFsdWUgPT09ICd0cnVlJykge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmIChhdHRyaWJ1dGVWYWx1ZSA9PT0gJ2ZhbHNlJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtXG4gKiBAcmV0dXJucyB7bnVtYmVyIHwgdW5kZWZpbmVkfSAtIG51bWJlciBpZiBpbXBsaWNpdCBoZWFkaW5nIG9yIGFyaWEtbGV2ZWwgcHJlc2VudCwgb3RoZXJ3aXNlIHVuZGVmaW5lZFxuICovXG5mdW5jdGlvbiBjb21wdXRlSGVhZGluZ0xldmVsKGVsZW1lbnQpIHtcbiAgLy8gaHR0cHM6Ly93M2MuZ2l0aHViLmlvL2h0bWwtYWFtLyNlbC1oMS1oNlxuICAvLyBodHRwczovL3czYy5naXRodWIuaW8vaHRtbC1hYW0vI2VsLWgxLWg2XG4gIGNvbnN0IGltcGxpY2l0SGVhZGluZ0xldmVscyA9IHtcbiAgICBIMTogMSxcbiAgICBIMjogMixcbiAgICBIMzogMyxcbiAgICBINDogNCxcbiAgICBINTogNSxcbiAgICBINjogNlxuICB9O1xuICAvLyBleHBsaWNpdCBhcmlhLWxldmVsIHZhbHVlXG4gIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93YWktYXJpYS0xLjIvI2FyaWEtbGV2ZWxcbiAgY29uc3QgYXJpYUxldmVsQXR0cmlidXRlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2FyaWEtbGV2ZWwnKSAmJiBOdW1iZXIoZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2FyaWEtbGV2ZWwnKSk7XG4gIHJldHVybiBhcmlhTGV2ZWxBdHRyaWJ1dGUgfHwgaW1wbGljaXRIZWFkaW5nTGV2ZWxzW2VsZW1lbnQudGFnTmFtZV07XG59Il0sIm1hcHBpbmdz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